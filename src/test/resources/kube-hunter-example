2023-09-02 15:43:13,686 INFO kube_hunter.modules.report.collector Started hunting
2023-09-02 15:43:13,687 INFO kube_hunter.modules.report.collector Discovering Open Kubernetes Services
2023-09-02 15:43:13,702 INFO kube_hunter.modules.report.collector Found vulnerability "Read access to pod's service account token" in Local to Pod (kube-hunter-rc9xf)
2023-09-02 15:43:13,703 INFO kube_hunter.modules.report.collector Found vulnerability "CAP_NET_RAW Enabled" in Local to Pod (kube-hunter-rc9xf)
2023-09-02 15:43:13,709 INFO kube_hunter.modules.report.collector Found vulnerability "Access to pod's secrets" in Local to Pod (kube-hunter-rc9xf)
2023-09-02 15:43:20,936 INFO kube_hunter.modules.report.collector Found open service "Kubelet API" at 10.42.1.1:10250
2023-09-02 15:43:20,955 INFO kube_hunter.modules.report.collector Found open service "Kubelet API" at 10.42.1.0:10250
2023-09-02 15:43:28,352 INFO kube_hunter.modules.report.collector Found open service "API Server" at 10.43.0.1:443
2023-09-02 15:43:28,416 INFO kube_hunter.modules.report.collector Found vulnerability "Access to API using service account token" in 10.43.0.1:443
2023-09-02 15:43:28,437 INFO kube_hunter.modules.report.collector Found vulnerability "K8s Version Disclosure" in 10.43.0.1:443
{"nodes": [{"type": "Node/Master", "location": "10.42.1.1"}, {"type": "Node/Master", "location": "10.42.1.0"}, {"type": "Node/Master", "location": "10.43.0.1"}], "services": [{"service": "Kubelet API", "location": "10.42.1.1:10250"}, {"service": "Kubelet API", "location": "10.42.1.0:10250"}, {"service": "API Server", "location": "10.43.0.1:443"}], "vulnerabilities": [{"location": "Local to Pod (kube-hunter-rc9xf)", "vid": "KHV050", "category": "Credential Access // Access container service account", "severity": "low", "vulnerability": "Read access to pod's service account token", "description": "Accessing the pod service account token gives an attacker the option to use the server API", "evidence": "eyJhbGciOiJSUzI1NiIsImtpZCI6InV4VXlvOXBKcnlCV2dmdlRCcEMzaUNOMHdIalc0cWZlSU50NTB5QjFYR2sifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiLCJrM3MiXSwiZXhwIjoxNzI1MjA1MzkxLCJpYXQiOjE2OTM2NjkzOTEsImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJrdWJlLWNvbmZpZy1zY2FubmVyIiwicG9kIjp7Im5hbWUiOiJrdWJlLWh1bnRlci1yYzl4ZiIsInVpZCI6IjczOTg5MjQwLWEzNTMtNDUyMS04Nzg0LWY5NDYxOWJiMGZlNCJ9LCJzZXJ2aWNlYWNjb3VudCI6eyJuYW1lIjoiZGVmYXVsdCIsInVpZCI6IjQ0OWFmNjcxLTQxOTMtNDg1ZC05ODUzLWZkMmFhZDc3ZWE4MSJ9LCJ3YXJuYWZ0ZXIiOjE2OTM2NzI5OTh9LCJuYmYiOjE2OTM2NjkzOTEsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDprdWJlLWNvbmZpZy1zY2FubmVyOmRlZmF1bHQifQ.E3KzUZ9F6cuGc3JaIx0Mlsb8tEE8DfyBW9CV4IniCQZcRvX3SCTu7MaDRBacEckHEpahHqjaVBNVUp1JmTSPIGItHky03JWH-TIqxLIeteJG3_Nk3I-vBvoThYJt4fQg5lEVpbnKP0xje0ZWMwN6cvrI7rvXOOMUVw7oNsgOdvtGQQrXfJVrTtsayhiUwoARRAMMwbequM8R9-T6h5G9aoapzniRNr6DLONYS-vMua73cZTE0WBsmhEu9WsThOH9aiioGSHFpTOzuCqkxtG3_pJHF27LrE1v6FUoQ8AML-cgo8x7nOZGRXZ4EG1txzwIGtU9Z5alGi-fcWiuAYt7wA", "avd_reference": "https://avd.aquasec.com/kube-hunter/khv050/", "hunter": "Access Secrets"}, {"location": "Local to Pod (kube-hunter-rc9xf)", "vid": "None", "category": "Lateral Movement // ARP poisoning and IP spoofing", "severity": "medium", "vulnerability": "CAP_NET_RAW Enabled", "description": "CAP_NET_RAW is enabled by default for pods.\n    If an attacker manages to compromise a pod,\n    they could potentially take advantage of this capability to perform network\n    attacks on other pods running on the same node", "evidence": "", "avd_reference": "https://avd.aquasec.com/kube-hunter/none/", "hunter": "Pod Capabilities Hunter"}, {"location": "Local to Pod (kube-hunter-rc9xf)", "vid": "None", "category": "Credential Access // Access container service account", "severity": "low", "vulnerability": "Access to pod's secrets", "description": "Accessing the pod's secrets within a compromised pod might disclose valuable data to a potential attacker", "evidence": "['/var/run/secrets/kubernetes.io/serviceaccount/namespace', '/var/run/secrets/kubernetes.io/serviceaccount/ca.crt', '/var/run/secrets/kubernetes.io/serviceaccount/token', '/var/run/secrets/kubernetes.io/serviceaccount/..2023_09_02_15_43_11.1924186431/ca.crt', '/var/run/secrets/kubernetes.io/serviceaccount/..2023_09_02_15_43_11.1924186431/token', '/var/run/secrets/kubernetes.io/serviceaccount/..2023_09_02_15_43_11.1924186431/namespace']", "avd_reference": "https://avd.aquasec.com/kube-hunter/none/", "hunter": "Access Secrets"}, {"location": "10.43.0.1:443", "vid": "KHV005", "category": "Discovery // Access the K8S API Server", "severity": "medium", "vulnerability": "Access to API using service account token", "description": "The API Server port is accessible.\n    Depending on your RBAC settings this could expose access to or control of your cluster.", "evidence": "b'{\"kind\":\"APIVersions\",\"versions\":[\"v1\"],\"serverAddressByClientCIDRs\":[{\"clientCIDR\":\"0.0.0.0/0\",\"serverAddress\":\"192.168.123.201:6443\"}]}\\n'", "avd_reference": "https://avd.aquasec.com/kube-hunter/khv005/", "hunter": "API Server Hunter"}, {"location": "10.43.0.1:443", "vid": "KHV002", "category": "Initial Access // Exposed sensitive interfaces", "severity": "high", "vulnerability": "K8s Version Disclosure", "description": "The kubernetes version could be obtained from the /version endpoint", "evidence": "v1.27.3+k3s1", "avd_reference": "https://avd.aquasec.com/kube-hunter/khv002/", "hunter": "Api Version Hunter"}]}
